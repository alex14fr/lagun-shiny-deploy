This downloads, builds, and create a chroot for a R/Shiny/Lagun server listening on *:8080.

Dependencies : Linux kernel with namespaces (mount, user, PID), usual utilities (including unshare(1)), git, rsync, opendoas (or sudo symlinked to doas).

The build is not made in a safe container (no pivot_root/umount, no capability drop, no seccomp, no IPC/network isolation...), don't run it as privilegied user.

root privileges are required to create /dev/{random,urandom,full,null,zero} (the scripts will use doas to do this, run them as normal user).

To create the build chroot and build the beast, run :
   $ ./01_mkbuild && ./02_build

Then, to extract the relevant files in a rootfs directory, and create rootfs.tar.xz, run
   $ MAKEDEV=1 ./03_mkroot
(again, you'll need to be able to doas root to create the same special nodes in rootfs/dev)

and test using (unsafe container, see above):
   $ ./99_enter_rootfs /entry

If you use a proper container runtime (recommended), to create rootfs you can run
   $ ./03_mkroot
since /dev will be populated by your runtime anyway.

The included Dockerfile can be used to create a container from the built rootfs.tar.xz available at <https://janona.perso.math.cnrs.fr/shiny-rootfs.tar.xz>.

Author : Alexandre Janon <alexandre . janon at u-psud . fr>


